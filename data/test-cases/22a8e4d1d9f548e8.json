{"uid":"22a8e4d1d9f548e8","name":"测试记住密码功能","fullName":"tests.test_login.TestLogin#test_remember_password","historyId":"6d2efd9b292c23685f59bc1218b135a3","time":{"start":1746379231380,"stop":1746379254214,"duration":22834},"description":"测试记住密码功能","descriptionHtml":"<p>测试记住密码功能</p>\n","status":"failed","statusMessage":"AssertionError: 记住密码功能未正常工作，既没有预填用户名也没有自动登录\nassert False","statusTrace":"self = <tests.test_login.TestLogin object at 0x000001FB9438BF50>, driver = <utils.webdriver.WebDriver object at 0x000001FB9437FB50>\nbase_url = 'http://211.87.232.162:8080'\n\n    @allure.story(\"记住密码功能\")\n    @allure.title(\"测试记住密码功能\")\n    def test_remember_password(self, driver, base_url):\n        \"\"\"测试记住密码功能\"\"\"\n        with allure.step(\"创建登录页面对象\"):\n            login_page = LoginPage(driver)\n    \n        with allure.step(f\"导航到登录页面 {base_url}\"):\n            login_page.navigate_to(base_url)\n            login_page.wait_for_page_load()\n    \n        with allure.step(\"获取有效用户信息\"):\n            valid_user = get_user('valid_user')\n    \n        with allure.step(\"执行登录操作（勾选记住密码）\"):\n            login_page.login(valid_user['username'], valid_user['password'], remember=True)\n    \n        with allure.step(\"验证登录成功\"):\n            assert login_page.is_login_successful(), \"登录失败，未能成功登录\"\n    \n        with allure.step(\"保存cookies\"):\n            cookies = driver.get_cookies()\n    \n        with allure.step(\"重新打开浏览器（模拟）\"):\n            driver.delete_all_cookies()\n    \n        with allure.step(\"访问登录页面\"):\n            login_page.navigate_to(base_url)\n            login_page.wait_for_page_load()\n    \n        with allure.step(\"验证用户名是否已预填\"):\n            username_field = driver.find_element(*login_page.USERNAME_INPUT)\n            current_username = username_field.get_attribute(\"value\")\n    \n        with allure.step(f\"预填的用户名: {current_username}\"):\n            print(f\"预填的用户名: {current_username}\")\n    \n        # 验证用户名是否预填或自动登录（取决于系统实现）\n        # 注意：有些系统会直接自动登录，有些只会预填用户名\n        if current_username:\n            assert current_username == valid_user['username'], \"记住密码功能未正常工作，用户名未预填\"\n            print(\"记住密码功能正常工作，用户名已预填\")\n        else:\n            # 如果用户名未预填，检查是否自动登录了\n            time.sleep(2)  # 等待可能的自动登录\n            try:\n                # 尝试查找导航下拉菜单组件\n                nav_items = driver.find_elements(By.CLASS_NAME, \"nav-item\")\n                for item in nav_items:\n                    if \"dropdown\" in item.get_attribute(\"class\") and \"show\" in item.get_attribute(\"class\"):\n                        print(\"记住密码功能导致自动登录，测试通过\")\n                        return\n                # 另一种尝试\n                if driver.find_elements(By.CLASS_NAME, \"nav-item.dropdown.show\"):\n                    print(\"记住密码功能导致自动登录，测试通过\")\n                    return\n            except:\n                pass\n    \n>           assert False, \"记住密码功能未正常工作，既没有预填用户名也没有自动登录\"\nE           AssertionError: 记住密码功能未正常工作，既没有预填用户名也没有自动登录\nE           assert False\n\ntests\\test_login.py:148: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"web_driver","time":{"start":1746379222928,"stop":1746379227542,"duration":4614},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"base_url","time":{"start":1746379231380,"stop":1746379231380,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"driver","time":{"start":1746379231380,"stop":1746379231380,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false}],"testStage":{"description":"测试记住密码功能","status":"failed","statusMessage":"AssertionError: 记住密码功能未正常工作，既没有预填用户名也没有自动登录\nassert False","statusTrace":"self = <tests.test_login.TestLogin object at 0x000001FB9438BF50>, driver = <utils.webdriver.WebDriver object at 0x000001FB9437FB50>\nbase_url = 'http://211.87.232.162:8080'\n\n    @allure.story(\"记住密码功能\")\n    @allure.title(\"测试记住密码功能\")\n    def test_remember_password(self, driver, base_url):\n        \"\"\"测试记住密码功能\"\"\"\n        with allure.step(\"创建登录页面对象\"):\n            login_page = LoginPage(driver)\n    \n        with allure.step(f\"导航到登录页面 {base_url}\"):\n            login_page.navigate_to(base_url)\n            login_page.wait_for_page_load()\n    \n        with allure.step(\"获取有效用户信息\"):\n            valid_user = get_user('valid_user')\n    \n        with allure.step(\"执行登录操作（勾选记住密码）\"):\n            login_page.login(valid_user['username'], valid_user['password'], remember=True)\n    \n        with allure.step(\"验证登录成功\"):\n            assert login_page.is_login_successful(), \"登录失败，未能成功登录\"\n    \n        with allure.step(\"保存cookies\"):\n            cookies = driver.get_cookies()\n    \n        with allure.step(\"重新打开浏览器（模拟）\"):\n            driver.delete_all_cookies()\n    \n        with allure.step(\"访问登录页面\"):\n            login_page.navigate_to(base_url)\n            login_page.wait_for_page_load()\n    \n        with allure.step(\"验证用户名是否已预填\"):\n            username_field = driver.find_element(*login_page.USERNAME_INPUT)\n            current_username = username_field.get_attribute(\"value\")\n    \n        with allure.step(f\"预填的用户名: {current_username}\"):\n            print(f\"预填的用户名: {current_username}\")\n    \n        # 验证用户名是否预填或自动登录（取决于系统实现）\n        # 注意：有些系统会直接自动登录，有些只会预填用户名\n        if current_username:\n            assert current_username == valid_user['username'], \"记住密码功能未正常工作，用户名未预填\"\n            print(\"记住密码功能正常工作，用户名已预填\")\n        else:\n            # 如果用户名未预填，检查是否自动登录了\n            time.sleep(2)  # 等待可能的自动登录\n            try:\n                # 尝试查找导航下拉菜单组件\n                nav_items = driver.find_elements(By.CLASS_NAME, \"nav-item\")\n                for item in nav_items:\n                    if \"dropdown\" in item.get_attribute(\"class\") and \"show\" in item.get_attribute(\"class\"):\n                        print(\"记住密码功能导致自动登录，测试通过\")\n                        return\n                # 另一种尝试\n                if driver.find_elements(By.CLASS_NAME, \"nav-item.dropdown.show\"):\n                    print(\"记住密码功能导致自动登录，测试通过\")\n                    return\n            except:\n                pass\n    \n>           assert False, \"记住密码功能未正常工作，既没有预填用户名也没有自动登录\"\nE           AssertionError: 记住密码功能未正常工作，既没有预填用户名也没有自动登录\nE           assert False\n\ntests\\test_login.py:148: AssertionError","steps":[{"name":"创建登录页面对象","time":{"start":1746379231381,"stop":1746379231381,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"导航到登录页面 http://211.87.232.162:8080","time":{"start":1746379231381,"stop":1746379231436,"duration":55},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"获取有效用户信息","time":{"start":1746379231436,"stop":1746379231436,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"执行登录操作（勾选记住密码）","time":{"start":1746379231436,"stop":1746379231953,"duration":517},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"验证登录成功","time":{"start":1746379231953,"stop":1746379232034,"duration":81},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"保存cookies","time":{"start":1746379232034,"stop":1746379232037,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"重新打开浏览器（模拟）","time":{"start":1746379232037,"stop":1746379232043,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"访问登录页面","time":{"start":1746379232044,"stop":1746379232108,"duration":64},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"验证用户名是否已预填","time":{"start":1746379232108,"stop":1746379232124,"duration":16},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false},{"name":"预填的用户名: ","time":{"start":1746379232124,"stop":1746379232124,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false}],"attachments":[{"uid":"a05bfcbe40a2dc54","name":"失败截图_20250505_012054","source":"a05bfcbe40a2dc54.png","type":"image/png","size":25751},{"uid":"9c46e8207002c6a","name":"页面源代码","source":"9c46e8207002c6a.html","type":"text/html","size":1163},{"uid":"84e1dc572d7c862a","name":"stdout","source":"84e1dc572d7c862a.txt","type":"text/plain","size":640}],"parameters":[],"attachmentStep":false,"hasContent":true,"stepsCount":10,"attachmentsCount":3,"shouldDisplayMessage":true},"afterStages":[{"name":"web_driver::0","time":{"start":1746379301470,"stop":1746379307739,"duration":6269},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentStep":false,"hasContent":false,"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false}],"labels":[{"name":"story","value":"记住密码功能"},{"name":"epic","value":"用户管理"},{"name":"feature","value":"登录功能"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_login"},{"name":"subSuite","value":"TestLogin"},{"name":"host","value":"djc"},{"name":"thread","value":"6688-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_login"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"22a8e4d1d9f548e8.json","parameterValues":[]}